# BLoc (Business Logic Component)

Digunakan untuk menghubungkan `state cubit` dengan `UI`. Untuk menggunakannya, masukkan library `flutter_bloc` dalam projek.

Dalam penggunaannya ada 2 langkah utama:

1. Buat provider pada main component berisi obj cubit

    ```dart
    MultiBlocProvider(
        providers: [
            BlocProvider.value(value: barcodeCubit),
        ],
        child: 
    )
    ```

2. di child, kita bisa gunakan listener dan builder:

    - BlocListener<HandheldConnectionCubit, HandheldConnectionState>(listener: (ctx, state){}, child) (digunakan untuk callback dalam class namun tidak secara langsung me-rebuild UI).
    - BlocBuilder<HandheldConnectionCubit, HandheldConnectionState>( builder: (context, state) {});

    Alternatifnya, kita bisa pakai `BlocConsumer` yang memiliki props `listener` dan `builder`.

    Biasanya pada bagian listener, kita mengmbil nilai state

    ```dart
    final cubit = context.read<HandheldConnectionCubit>();
    ```

3. Kita bisa mentrigger perubahan nilai cubit dimanapun

    ```dart
    handheldCommand.connect(address);
    ```

## Cubit

Merupakan class yang menghubungkan state dengan bloc

```dart
class HandheldConnectionState extends Equatable {
  final HandheldStatus status;
  final List<BluetoothDevice> devices;
  final String? error;

  const HandheldConnectionState({
    required this.status,
    this.devices = const [],
    this.error,
  });

  HandheldConnectionState copyWith({
    HandheldStatus? status,
    List<BluetoothDevice>? devices,
    String? error,
  }) {
    return HandheldConnectionState(
      status: status ?? this.status,
      devices: devices ?? this.devices,
      error: error,
    );
  }

  @override
  List<Object?> get props => [status, devices, error];
}
```

```dart
class PrinterConnectionCubit extends Cubit<PrinterConnectionState> {
  PrinterConnectionCubit(): super(const PrinterConnectionState(status: PrinterStatus.idle));

  void connecting() =>
      emit(state.copyWith(status: PrinterStatus.connecting));

  void connected() =>
      emit(state.copyWith(status: PrinterStatus.connected));

  void disconnected() =>
      emit(state.copyWith(status: PrinterStatus.disconnected));

  void error(String msg) =>
      emit(state.copyWith(
        status: PrinterStatus.error,
        error: msg,
      ));
}
```

agar app tidak "ngehang" kita perlu bikin agar